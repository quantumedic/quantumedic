webpackJsonp([6],{"/eoz":function(t,n){},"/mOQ":function(t,n){},GXkQ:function(t,n){},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,o,u,a,c,r=e("7+uW"),s=e("NYxO"),f=e("Dd8w"),d=e.n(f),l=e("//Fk"),_=e.n(l),g=e("mtWM"),m=e.n(g),T=function(t){return 200===t.status&&function(t){switch(t.data.code){case 200:return t;case 401:return token.clean(),window.location.reload(),_.a.reject(t.data.msg);default:return window.alert(t.data.msg),_.a.reject(t.data)}}(t)},I=window.localStorage,C={get:function(t){return I.getItem(t)},set:function(t,n){I.setItem("uid",t),I.setItem("token",n)},clean:function(){I.removeItem("uid"),I.removeItem("token")}},A=(i="http://api.quantumedic.com",function(t){var n=m.a.create({baseURL:i+t});return n.interceptors.request.use(function(t){return C.get("uid")&&(t.headers.common.Authorization="uid="+C.get("uid")+";token="+C.get("token")),t},function(t){return _.a.reject(t)}),n.interceptors.response.use(function(t){return T(t)},function(t){return _.a.reject(t)}),n}),p=function(){return A("/account")},N=function(){return A("/doc")},h=function(t){return p().post("/register",t)},E=function(t){return p().post("/login",t)},v=function(t,n,e){t.then(function(t){var i=t.data.result.token,o=t.data.result.uid;n("ACCOUNT_SIGN_IN",{token:i,uid:o}),e&&e()},function(t){n("ACCOUNT_SIGN_ERROR",{err:t})})},U={actions:{signup:function(t,n){var e=t.commit,i=n.info,o=n.success;v(h(i),e,o)},signin:function(t,n){var e=t.commit,i=n.info,o=n.success;e("SUBMITTING_ACCOUNT_INFO"),v(E(i),e,o)},signout:function(t,n){(0,t.commit)("ACCOUNT_SIGN_OUT"),n&&n()}}},S=e("bOdI"),G=e.n(S),R={state:{submitting:!1,ifLogged:C.get("uid")&&!0},mutations:(o={},G()(o,"SUBMITTING_ACCOUNT_INFO",function(t,n){t.submitting=!0,t.ifLogged=!1}),G()(o,"ACCOUNT_SIGN_IN",function(t,n){C.set(n.uid,n.token),t.ifLogged=!0,t.submitting=!1}),G()(o,"ACCOUNT_SIGN_ERROR",function(t,n){t.ifLogged=!1,t.submitting=!1}),G()(o,"ACCOUNT_SIGN_OUT",function(t){t.ifLogged=!1,C.clean(),C.submitting=!1}),o)},O=d()({},U,R),L=function(){return p().get("/info")},b=function(t){return p().put("/info",t)},k={actions:{getAccount:function(t){var n=t.commit;L().then(function(t){var e=t.data.result;n("GET_ACCOUNT_INFO",{info:e})},function(t){n("GET_ACCOUNT_INFO_ERROR",{err:t})})},updateAccount:function(t,n){var e=t.commit,i=n.info,o=n.success;e("UPDATING_ACCOUNT"),b(i).then(function(t){var n=t.data.result;e("UPDATING_ACCOUNT_SUCCESS",{info:n}),o&&o()},function(t){e("UPDATING_ACCOUNT_FAIL",{err:t})})}}},x={state:{user_info:{},updating:!1},mutations:(u={},G()(u,"GET_ACCOUNT_INFO",function(t,n){t.user_info=n.info}),G()(u,"GET_ACCOUNT_INFO_ERROR",function(t,n){t.user_info={}}),G()(u,"UPDATING_ACCOUNT",function(t,n){t.updating=!0}),G()(u,"UPDATING_ACCOUNT_SUCCESS",function(t,n){t.user_info=n.info,t.updating=!1}),G()(u,"UPDATING_ACCOUNT_FAIL",function(t,n){t.updating=!1}),u)},F=d()({},k,x),w=function(t){return N().get("",{params:{id:t}})},Q=function(t){return N().put("",t)},D={actions:{getArticleDetail:function(t,n){var e=t.commit,i=n.id,o=n.success;e("REQUESTING_ARITCLE"),w(i).then(function(t){var n=t.data.result;e("REQUESTING_ARITCLE_SUCCESS",{detail:n}),o&&o()},function(t){e("REQUESTING_ARITCLE_FAIL",{err:t})})},editArticleInfo:function(t,n){var e=t.commit,i=n.info,o=n.success;e("EDITING_ARTICLE"),Q(i).then(function(t){var n=t.data.result;e("EDITING_ARTICLE_SUCCESS",{detail:n}),o&&o()},function(t){e("EDITING_ARTICLE_FAIL",{err:t})})}}},M={state:{requesting:!1,article_unexistance:!1,article_detail:{},editing:!1},mutations:(a={},G()(a,"REQUESTING_ARITCLE",function(t,n){t.requesting=!0,t.article_unexistance=!1}),G()(a,"REQUESTING_ARITCLE_SUCCESS",function(t,n){t.article_detail=n.detail,t.requesting=!1,t.article_unexistance=!1}),G()(a,"REQUESTING_ARITCLE_FAIL",function(t,n){t.requesting=!1,t.article_unexistance=!0}),G()(a,"EDITING_ARTICLE",function(t,n){t.editing=!0}),G()(a,"EDITING_ARTICLE_SUCCESS",function(t,n){t.article_detail=n.detail,t.editing=!1}),G()(a,"EDITING_ARTICLE_FAIL",function(t,n){t.editing=!1}),a)},q=d()({},D,M),j=function(t){return A("/tag").get("",{params:{id:t,need_doc:!0}})},y={actions:{getTagDetail:function(t,n){var e=t.commit,i=n.id;n.success;e("REQUESTING_TAG"),j(i).then(function(t){var n=t.data.result;e("REQUESTING_TAG_SUCCESS",{detail:n})},function(t){e("REQUESTING_TAG_FAIL",{err:t})})}}},P={state:{requesting:!1,tag_detail:{},tag_unexistance:!1},mutations:(c={},G()(c,"REQUESTING_TAG",function(t,n){t.requesting=!0,t.tag_unexistance=!1}),G()(c,"REQUESTING_TAG_SUCCESS",function(t,n){t.tag_detail=n.detail,t.tag_unexistance=!1,t.requesting=!1}),G()(c,"REQUESTING_TAG_FAIL",function(t,n){t.tag_unexistance=!0,t.requesting=!1}),c)},z=d()({},y,P);r.a.use(s.a);var B=new s.a.Store({modules:{AuthModule:O,AccountModule:F,ArticleModule:q,TagModule:z}}),H={computed:d()({},Object(s.c)({ifLogged:function(t){return t.AuthModule.ifLogged},user_info:function(t){return t.AccountModule.user_info}})),methods:d()({},Object(s.b)({getAccount:"getAccount",signout:"signout"}),{logout:function(){var t=this;this.signout(function(){t.$router.push({name:"home"})})},init:function(){this.ifLogged&&this.getAccount()}}),mounted:function(){this.init()},watch:{ifLogged:"init"}},V={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"container-fluid navbar-fixed-top handbook-header"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-xs-6"},[e("router-link",{attrs:{to:{name:"home"}}},[t._v("Handbook")])],1),t._v(" "),t.ifLogged?e("div",{staticClass:"col-xs-6 text-right small navbar-menu"},[e("router-link",{attrs:{to:{name:"account",params:{tab:"profile"}}}},[e("i",{staticClass:"fa fa-user-circle-o"}),t._v("\n\t\t\t\t"+t._s(t.user_info.username)+"\n\t\t\t")]),t._v(" "),e("a",{attrs:{href:""}},[t._v("收藏")]),t._v(" "),e("a",{attrs:{href:""}},[t._v("我的贡献")]),t._v(" "),e("a",{on:{click:t.logout}},[t._v("退出")])],1):e("div",{staticClass:"col-xs-6 text-right small navbar-menu"},[e("router-link",{attrs:{to:{name:"account",params:{tab:"login"}}}},[t._v("\n\t\t\t\t登录/注册\n\t\t\t")])],1)])])},staticRenderFns:[]};var $={name:"App",store:B,components:{HeaderBar:e("VU/8")(H,V,!1,function(t){e("/mOQ")},"data-v-08dc174e",null).exports}},J={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"app"}},[n("header-bar"),this._v(" "),n("div",{staticClass:"container"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view")],1)],1)],1)},staticRenderFns:[]};var W=e("VU/8")($,J,!1,function(t){e("/eoz")},null,null).exports,X=e("/ocq");r.a.use(X.a);var K=new X.a({mode:"history",scrollBehavior:function(t,n,e){if(e)return e;var i={};return t.hash&&(i.selector=t.hash),t.matched.some(function(t){return t.meta.scrollToTop})&&(i.x=0,i.y=0),i},routes:[{path:"/",name:"home",component:function(t){return e.e(4).then(function(){var n=[e("Qt9A")];t.apply(null,n)}.bind(this)).catch(e.oe)}},{path:"/account/:tab",name:"account",component:function(t){return e.e(1).then(function(){var n=[e("FGjL")];t.apply(null,n)}.bind(this)).catch(e.oe)}},{path:"/edit/:id",name:"edit",component:function(t){return e.e(0).then(function(){var n=[e("KM4z")];t.apply(null,n)}.bind(this)).catch(e.oe)}},{path:"/doc/:id",name:"doc",component:function(t){return e.e(2).then(function(){var n=[e("pvNT")];t.apply(null,n)}.bind(this)).catch(e.oe)}},{path:"/tag/:id",name:"tag",component:function(t){return e.e(3).then(function(){var n=[e("VrAg")];t.apply(null,n)}.bind(this)).catch(e.oe)}}]}),Y=e("9JMe");e("GXkQ");r.a.config.productionTip=!1,Object(Y.sync)(B,K),new r.a({el:"#app",router:K,components:{App:W},template:"<App/>"}),window.router=K}},["NHnr"]);
//# sourceMappingURL=app.02c7543a7c4a915a77b5.js.map